---
title: Configurarea creării automate a facturilor proforma
description: Acest subiect oferă informații despre configurarea creării automate a facturilor proforma.
author: rumant
manager: Annbe
ms.date: 10/13/2020
ms.topic: article
ms.service: dynamics-365-customerservice
ms.reviewer: kfend
ms.author: rumant
ms.openlocfilehash: e146dd510b3795d52d164fc6acf8e5400ba11310
ms.sourcegitcommit: 11a61db54119503e82faec5f99c4273e8d1247e5
ms.translationtype: HT
ms.contentlocale: ro-RO
ms.lasthandoff: 10/16/2020
ms.locfileid: "4082705"
---
# <a name="configure-automated-proforma-invoice-creation"></a><span data-ttu-id="82fbb-103">Configurarea creării automate a facturilor proforma</span><span class="sxs-lookup"><span data-stu-id="82fbb-103">Configure automated proforma invoice creation</span></span>

<span data-ttu-id="82fbb-104">_**Se aplică la:** implementare simplificată - facturare de la tranzacție la proforma_</span><span class="sxs-lookup"><span data-stu-id="82fbb-104">_**Applies To:** Lite deployment - deal to proforma invoicing_</span></span>

<span data-ttu-id="82fbb-105">Puteți configura crearea automată a facturilor în Dynamics 365 Project Operations.</span><span class="sxs-lookup"><span data-stu-id="82fbb-105">You can configure automatic invoice creation in Dynamics 365 Project Operations.</span></span> <span data-ttu-id="82fbb-106">Sistemul creează o schiță de factură proforma pe baza programului de facturare pentru fiecare contract de proiect și linie de contract.</span><span class="sxs-lookup"><span data-stu-id="82fbb-106">The system creates a draft proforma invoice based on the invoice schedule for each project contract and contract line.</span></span> <span data-ttu-id="82fbb-107">Programările facturilor sunt configurate la nivelul liniei contractului.</span><span class="sxs-lookup"><span data-stu-id="82fbb-107">Invoice schedules are configured at the contract line level.</span></span> <span data-ttu-id="82fbb-108">Fiecare linie dintr-un contract poate avea un program de facturare distinct sau același program de facturare poate fi inclus pe fiecare linie a contractului.</span><span class="sxs-lookup"><span data-stu-id="82fbb-108">Each line on a contract can have a distinct invoice schedule, or the same invoice schedule can be included on every line of the contract.</span></span>

<span data-ttu-id="82fbb-109">Când creați o factură, sistemul creează întotdeauna cel puțin o factură per contract de proiect.</span><span class="sxs-lookup"><span data-stu-id="82fbb-109">When you create an invoice, the system always creates at least one invoice per project contract.</span></span> <span data-ttu-id="82fbb-110">În unele cazuri, pot exista mai multe facturi create.</span><span class="sxs-lookup"><span data-stu-id="82fbb-110">In some cases, there may be multiple invoices created.</span></span>

<span data-ttu-id="82fbb-111">De exemplu, dacă contractul are mai mulți clienți, se va crea același număr de facturi ca și numărul de clienți care au tranzacții facturabile de facturat în contractul respectiv de proiect.</span><span class="sxs-lookup"><span data-stu-id="82fbb-111">For example, if the contract has multiple customers, the same number of invoices will be created as the number of customers that have billable transactions to invoice on that project contract.</span></span>

## <a name="understand-how-transactions-are-included-on-an-invoice"></a><span data-ttu-id="82fbb-112">Înțelegeți cum sunt incluse tranzacțiile pe o factură</span><span class="sxs-lookup"><span data-stu-id="82fbb-112">Understand how transactions are included on an invoice</span></span> 

<span data-ttu-id="82fbb-113">Uneori, fiecare linie de contract bazată pe proiect specifică un program de facturare separat.</span><span class="sxs-lookup"><span data-stu-id="82fbb-113">Sometimes, each project-based contract line specifies a separate invoice schedule.</span></span> <span data-ttu-id="82fbb-114">De exemplu, serviciile de implementare pentru contractul Adatum au următoarele linii contractuale:</span><span class="sxs-lookup"><span data-stu-id="82fbb-114">For example, implementation services for the Adatum contract have the following contract lines:</span></span>

- <span data-ttu-id="82fbb-115">Lucrarea prototip care este un preț fix cu două jaloane create manual.</span><span class="sxs-lookup"><span data-stu-id="82fbb-115">Prototype work that is a fixed price with two manually created milestones.</span></span>
- <span data-ttu-id="82fbb-116">Lucrarea de implementare care include timpul și va fi facturată bi-săptămânal, lunea.</span><span class="sxs-lookup"><span data-stu-id="82fbb-116">Implementation work that includes Time and will be billed bi-weekly on Mondays.</span></span>
- <span data-ttu-id="82fbb-117">Cheltuielile suportate care trebuie facturate lunar în prima zi de luni a fiecărei luni.</span><span class="sxs-lookup"><span data-stu-id="82fbb-117">Expenses incurred that need to be billed monthly on the first Monday of each month.</span></span>

<span data-ttu-id="82fbb-118">Planificările de facturi definite pentru fiecare dintre aceste două elemente rând arată ca următorul tabel:</span><span class="sxs-lookup"><span data-stu-id="82fbb-118">Invoice schedules defined on each of these two line items look like the following table:</span></span>

| <span data-ttu-id="82fbb-119">Linie contract</span><span class="sxs-lookup"><span data-stu-id="82fbb-119">Contract line</span></span> | <span data-ttu-id="82fbb-120">Dată rulare factură</span><span class="sxs-lookup"><span data-stu-id="82fbb-120">Invoice run date</span></span> | <span data-ttu-id="82fbb-121">Date de reducere tranzacție</span><span class="sxs-lookup"><span data-stu-id="82fbb-121">Transaction cut-off date</span></span> | <span data-ttu-id="82fbb-122">Data datei scadente</span><span class="sxs-lookup"><span data-stu-id="82fbb-122">Milestone date</span></span> | <span data-ttu-id="82fbb-123">Valoare jalon</span><span class="sxs-lookup"><span data-stu-id="82fbb-123">Milestone amount</span></span> |
| --- | --- | --- | --- | --- |
| <span data-ttu-id="82fbb-124">Lucrarea prototip</span><span class="sxs-lookup"><span data-stu-id="82fbb-124">Prototype work</span></span> | <span data-ttu-id="82fbb-125">5 octombrie, luni</span><span class="sxs-lookup"><span data-stu-id="82fbb-125">October 5, Monday</span></span> | - | <span data-ttu-id="82fbb-126">5 octombrie, luni</span><span class="sxs-lookup"><span data-stu-id="82fbb-126">October 5, Monday</span></span> | <span data-ttu-id="82fbb-127">5000 USD</span><span class="sxs-lookup"><span data-stu-id="82fbb-127">5000 USD</span></span> |
| - | <span data-ttu-id="82fbb-128">3 noiembrie, marți</span><span class="sxs-lookup"><span data-stu-id="82fbb-128">November 3, Tuesday</span></span> | - | <span data-ttu-id="82fbb-129">3 noiembrie, marți</span><span class="sxs-lookup"><span data-stu-id="82fbb-129">November 3, Tuesday</span></span> | <span data-ttu-id="82fbb-130">12,000 USD</span><span class="sxs-lookup"><span data-stu-id="82fbb-130">12,000 USD</span></span> |
| <span data-ttu-id="82fbb-131">Lucrarea de implementare</span><span class="sxs-lookup"><span data-stu-id="82fbb-131">Implementation work</span></span> | <span data-ttu-id="82fbb-132">5 octombrie, luni</span><span class="sxs-lookup"><span data-stu-id="82fbb-132">October 5, Monday</span></span> | <span data-ttu-id="82fbb-133">4 octombrie, duminică</span><span class="sxs-lookup"><span data-stu-id="82fbb-133">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="82fbb-134">19 octombrie, luni</span><span class="sxs-lookup"><span data-stu-id="82fbb-134">October 19, Monday</span></span> | <span data-ttu-id="82fbb-135">18 octombrie, duminică</span><span class="sxs-lookup"><span data-stu-id="82fbb-135">October 18, Sunday</span></span> | - | - |
| - | <span data-ttu-id="82fbb-136">2 noiembrie, luni</span><span class="sxs-lookup"><span data-stu-id="82fbb-136">November 2, Monday</span></span> | <span data-ttu-id="82fbb-137">1 noiembrie, duminică</span><span class="sxs-lookup"><span data-stu-id="82fbb-137">November 1, Sunday</span></span> | - | - |
| - | <span data-ttu-id="82fbb-138">16 noiembrie, luni</span><span class="sxs-lookup"><span data-stu-id="82fbb-138">November 16, Monday</span></span> | <span data-ttu-id="82fbb-139">15 noiembrie, duminică</span><span class="sxs-lookup"><span data-stu-id="82fbb-139">November 15, Sunday</span></span> | - | - |
| <span data-ttu-id="82fbb-140">Cheltuielile suportate</span><span class="sxs-lookup"><span data-stu-id="82fbb-140">Expenses incurred</span></span> | <span data-ttu-id="82fbb-141">5 octombrie, luni</span><span class="sxs-lookup"><span data-stu-id="82fbb-141">October 5, Monday</span></span> | <span data-ttu-id="82fbb-142">4 octombrie, duminică</span><span class="sxs-lookup"><span data-stu-id="82fbb-142">October 4, Sunday</span></span> | - | - |
| - | <span data-ttu-id="82fbb-143">2 noiembrie, luni</span><span class="sxs-lookup"><span data-stu-id="82fbb-143">November 2, Monday</span></span> | <span data-ttu-id="82fbb-144">1 noiembrie, duminică</span><span class="sxs-lookup"><span data-stu-id="82fbb-144">November 1, Sunday</span></span> | - | - |

<span data-ttu-id="82fbb-145">În acest exemplu când facturarea automată rulează:</span><span class="sxs-lookup"><span data-stu-id="82fbb-145">In this example when the automatic invoicing runs on:</span></span>

- <span data-ttu-id="82fbb-146">**4 octombrie sau orice altă dată înainte** : Nu se generează nicio factură pentru acest contract deoarece tabelul **Planificare factură** pentru fiecare dintre aceste linii de contract nu au data de 4 octombrie, duminică, ca dată de rulare a facturii.</span><span class="sxs-lookup"><span data-stu-id="82fbb-146">**October 4 or any date before** : No invoice is generated for this contract because the **Invoice Schedule** table for each of these contract lines doesn't call out October 4, Sunday as an invoice run date.</span></span>
- <span data-ttu-id="82fbb-147">**5 octombrie, luni** : Se generează o factură pentru:</span><span class="sxs-lookup"><span data-stu-id="82fbb-147">**October 5 Monday** : One invoice is generated for:</span></span>

    - <span data-ttu-id="82fbb-148">Lucrarea prototip care include jalonul, dacă este marcat ca **Gata de facturat**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-148">Prototype work that includes the milestone, if it is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="82fbb-149">Lucrarea de implementare care include toate tranzacțiile de timp create înainte de data limită a tranzacției de 4 octombrie, duminică, care este marcată ca **Gata de facturat**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-149">Implementation work that includes all Time transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="82fbb-150">Cheltuielile efectuate care includ toate Tranzacțiile de cheltuieli create înainte de data limită a tranzacției de 4 octombrie, duminică, care este marcată ca **Gata de facturat**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-150">Expense incurred that includes all Expense transactions created before the transaction cut-off date of October 4, Sunday, that is marked as **Ready to Invoice**.</span></span>
  
- <span data-ttu-id="82fbb-151">**La 6 octombrie sau orice altă dată înainte de 19 octombrie** : Nu se generează nicio factură pentru acest contract deoarece tabelul **Planificare factură** pentru fiecare dintre aceste linii de contract nu au data de 6 octombrie sau orice altă dată înainte de 19 octombrie ca dată de rulare a facturii.</span><span class="sxs-lookup"><span data-stu-id="82fbb-151">**On October 6 or any date before October 19** : No invoice is generated for this contract since the **Invoice Schedule** table for each of these contract lines does not call out October 6 or any date before October 19 as an invoice run date.</span></span>
- <span data-ttu-id="82fbb-152">**19 octombrie, luni** : Se generează o singură factură pentru lucrările de implementare care include toate tranzacțiile de timp create înainte de data limită a tranzacției de 18 octombrie, duminică, care este marcată ca **Gata de facturat**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-152">**October 19, Monday** : One invoice is generated for implementation work that includes all Time transactions created before the transaction cut-off date of October 18, Sunday, that is marked as **Ready to Invoice**.</span></span>
- <span data-ttu-id="82fbb-153">**2 noiembrie, luni** : Se generează o factură pentru:</span><span class="sxs-lookup"><span data-stu-id="82fbb-153">**November 2 Monday** : One invoice is generated for:</span></span>

    - <span data-ttu-id="82fbb-154">Lucrarea de implementare care include toate tranzacțiile de timp create înainte de data limită a tranzacției de 1 noiembrie, duminică, care este marcată ca **Gata de facturat**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-154">Implementation work that includes all Time transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>
    - <span data-ttu-id="82fbb-155">Cheltuielile efectuate care includ toate Tranzacțiile de cheltuieli create înainte de data limită a tranzacției de 1 noiembrie, duminică, care este marcată ca **Gata de facturat**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-155">Expense incurred that includes all Expense transactions created before the transaction cut-off date of November 1, Sunday, that is marked as **Ready to Invoice**.</span></span>

- <span data-ttu-id="82fbb-156">**3 noiembrie, marți** : Se generează o factură pentru lucrarea prototip care include jalonul important pentru 12000 USD, dacă este marcată ca **Gata de facturat**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-156">**November 3, Tuesday** : One invoice is generated for prototype work that includes the milestone for 12000 USD, if it is marked as **Ready to Invoice**.</span></span>

## <a name="configure-automatic-invoicing"></a><span data-ttu-id="82fbb-157">Configurați facturarea automată</span><span class="sxs-lookup"><span data-stu-id="82fbb-157">Configure automatic invoicing</span></span>

<span data-ttu-id="82fbb-158">Parcurgeți pașii următori pentru a configura o rulare factură automată.</span><span class="sxs-lookup"><span data-stu-id="82fbb-158">Complete the following steps to configure an automated invoice run.</span></span>

1. <span data-ttu-id="82fbb-159">În **Project Operations** , accesați **Setări** > **Configurare factură recurentă**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-159">In **Project Operations** , go to **Settings** > **Recurring Invoice Setup**.</span></span>
2. <span data-ttu-id="82fbb-160">Creați o operațiune de lot și denumiți-o **Operațiuni de proiect de creare facturi**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-160">Create a batch job, and name it **rPoject Operations Create Invoices**.</span></span> <span data-ttu-id="82fbb-161">Numele operațiunii de lot trebuie să includă cuvintele „creare facturi”.</span><span class="sxs-lookup"><span data-stu-id="82fbb-161">The name of the batch job must include the words, "create invoices".</span></span>
3. <span data-ttu-id="82fbb-162">În câmpul **Tip lucrare** , selectați **Fără**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-162">In the **Job Type** field, select **None**.</span></span> <span data-ttu-id="82fbb-163">În mod implicit, câmpurile **Frecvența zilnică** și **Este activ** sunt setate la **Da**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-163">By default, the **Frequency Daily** and **Is Active** fields are set to **Yes**.</span></span>
4. <span data-ttu-id="82fbb-164">Selectați **Rulați fluxul de lucru**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-164">Select **Run Workflow**.</span></span> <span data-ttu-id="82fbb-165">În caseta de dialog **Căutare înregistrare** , veți vedea trei fluxuri de lucru:</span><span class="sxs-lookup"><span data-stu-id="82fbb-165">In the **Look Up Record** dialog box, you will see three workflows:</span></span>

- <span data-ttu-id="82fbb-166">ProcessRunCaller</span><span class="sxs-lookup"><span data-stu-id="82fbb-166">ProcessRunCaller</span></span>
- <span data-ttu-id="82fbb-167">ProcessRunner</span><span class="sxs-lookup"><span data-stu-id="82fbb-167">ProcessRunner</span></span>
- <span data-ttu-id="82fbb-168">UpdateRoleUtilization</span><span class="sxs-lookup"><span data-stu-id="82fbb-168">UpdateRoleUtilization</span></span>

5. <span data-ttu-id="82fbb-169">Selectați **ProcessRunCaller** , apoi selectați **Adăugare**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-169">Select **ProcessRunCaller** , and then select **Add**.</span></span>
6. <span data-ttu-id="82fbb-170">În următoarea casetă de dialog, selectați **OK**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-170">In the next dialog box, select **OK**.</span></span> <span data-ttu-id="82fbb-171">Un flux de lucru **Stare de repaus** este urmat de un fux de lucru **Proces**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-171">A **Sleep** workflow is followed by a **Process** workflow.</span></span> 

> [!NOTE]
> <span data-ttu-id="82fbb-172">De asemenea, puteți selecta **ProcessRunner** în pasul 5.</span><span class="sxs-lookup"><span data-stu-id="82fbb-172">You can also select **ProcessRunner** in step 5.</span></span> <span data-ttu-id="82fbb-173">Apoi, când selectați **OK** , un flux de lucru **Proces** este urmat de un flux de lucru **Stare de repaus**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-173">Then, when you select **OK** , a **Process** workflow is followed by a **Sleep** workflow.</span></span>

<span data-ttu-id="82fbb-174">Fluxurile de lucru **ProcessRunCaller** și **ProcessRunner** creează facturi.</span><span class="sxs-lookup"><span data-stu-id="82fbb-174">The **ProcessRunCaller** and **ProcessRunner** workflows create invoices.</span></span> <span data-ttu-id="82fbb-175">**ProcessRunCaller** apelează **ProcessRunner**.</span><span class="sxs-lookup"><span data-stu-id="82fbb-175">**ProcessRunCaller** calls **ProcessRunner**.</span></span> <span data-ttu-id="82fbb-176">**ProcessRunner** este fluxul de lucru care creează de fapt facturile.</span><span class="sxs-lookup"><span data-stu-id="82fbb-176">**ProcessRunner** is the workflow that actually creates the invoices.</span></span> <span data-ttu-id="82fbb-177">Fluxul de lucru trece prin toate liniile de contract pentru care trebuie create facturile și creează facturi pentru acele linii.</span><span class="sxs-lookup"><span data-stu-id="82fbb-177">The workflow goes through all the contract lines that invoices must be created for, and creates invoices for those lines.</span></span> <span data-ttu-id="82fbb-178">Pentru a determina liniile de contract pentru care trebuie create facturile, lucrarea analizează datele de rulare a facturii pentru liniile de contract.</span><span class="sxs-lookup"><span data-stu-id="82fbb-178">To determine the contract lines that invoices must be created for, the job looks at invoice run dates for the contract lines.</span></span> <span data-ttu-id="82fbb-179">Dacă liniile de contract care aparțin unui contract au aceeași dată de rulare a facturii, tranzacțiile sunt combinate într-o singură factură care are două linii de factură.</span><span class="sxs-lookup"><span data-stu-id="82fbb-179">If contract lines that belong to one contract have the same invoice run date, the transactions are combined into one invoice that has two invoice lines.</span></span> <span data-ttu-id="82fbb-180">Dacă nu există tranzacții pentru care să fie create facturi, operațiunea ignoră crearea unei facturi.</span><span class="sxs-lookup"><span data-stu-id="82fbb-180">If there are no transactions to create invoices for, the job skips creating an invoice.</span></span>

<span data-ttu-id="82fbb-181">După ce **ProcessRunner** a terminat să ruleze, apelează **ProcessRunCaller** , oferă ora de sfârșit și este închis.</span><span class="sxs-lookup"><span data-stu-id="82fbb-181">After **ProcessRunner** has finished running, it calls **ProcessRunCaller** , provides the end time, and is closed.</span></span> <span data-ttu-id="82fbb-182">**ProcessRunCaller** pornește apoi un cronometru care rulează timp de 24 de ore de la ora de sfârșit specificată.</span><span class="sxs-lookup"><span data-stu-id="82fbb-182">**ProcessRunCaller** then starts a timer that runs for 24-hours from the specified end time.</span></span> <span data-ttu-id="82fbb-183">La sfârșitul cronometru, **ProcessRunCaller** este închis.</span><span class="sxs-lookup"><span data-stu-id="82fbb-183">At the end of the timer, **ProcessRunCaller** is closed.</span></span>

<span data-ttu-id="82fbb-184">Lucrarea proces de lot pentru crearea facturilor este o lucrare recurentă.</span><span class="sxs-lookup"><span data-stu-id="82fbb-184">The batch process job for creating invoices is a recurrent job.</span></span> <span data-ttu-id="82fbb-185">Dacă acest proces de lot rulează de mai multe ori, sunt create mai multe instanțe ale lucrării și cauzează erori.</span><span class="sxs-lookup"><span data-stu-id="82fbb-185">If this batch process is run many times, multiple instances of the job are created and causes errors.</span></span> <span data-ttu-id="82fbb-186">De aceea, ar trebui să porniți procesul de lot doar o singură dată și apoi reporniți-l numai dacă se oprește rularea.</span><span class="sxs-lookup"><span data-stu-id="82fbb-186">Therefore, you should start the batch process only one time, and then restart only if it stops running.</span></span>

> [!NOTE]
> <span data-ttu-id="82fbb-187">Facturarea în serie în Project Operations se execută numai pentru liniile de contract ale proiectului care sunt configurate de planurile de facturare.</span><span class="sxs-lookup"><span data-stu-id="82fbb-187">Batch invoicing in Project Operations only runs for project contract lines that are configured by invoice schedules.</span></span> <span data-ttu-id="82fbb-188">O linie de contract cu o metodă de facturare a prețurilor fixe trebuie să aibă configurate repere.</span><span class="sxs-lookup"><span data-stu-id="82fbb-188">A contract line with a fixed price billing method must have milestones configured.</span></span> <span data-ttu-id="82fbb-189">O linie de contract de proiect cu o metodă de facturare a timpului și a materialului va avea nevoie de o planificare a facturilor pe bază de date.</span><span class="sxs-lookup"><span data-stu-id="82fbb-189">A project contract line with a time and material billing method will need a date-based invoice schedule set up.</span></span>
